(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1367ab53"],{"06c5":function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("25f0"),r("3ca3");var s=r("6b75");function a(t,e){if(t){if("string"===typeof t)return Object(s["a"])(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(s["a"])(t,e):void 0}}},1511:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("main",{attrs:{role:"main"}},[r("div",{staticClass:"album py-5 bg-light"},[r("div",{staticClass:"container"},[r("UserProfileCard",{attrs:{"user-profile":t.profile,"initial-is-followed":t.isFollowed,"current-user":t.currentUser},on:{"after-follow":t.afterFollow,"after-unfollow":t.afterUnfollow}}),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-4"},[r("UserFollowingsCard",{attrs:{"user-followings":t.profile.Followings}}),r("br"),r("UserFollowersCard",{attrs:{"user-followers":t.profile.Followers}})],1),r("div",{staticClass:"col-md-8"},[r("UserCommentsCard",{attrs:{"user-comments":t.profile.Comments}}),r("br"),r("UserFavoritedRestaurantsCard",{attrs:{"user-favorites":t.profile.FavoritedRestaurants}})],1)])],1)])])},a=[],i=(r("4de4"),r("45fc"),r("96cf"),r("1da1")),o=r("5530"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"row no-gutters"},[r("div",{staticClass:"col-md-4"},[r("img",{attrs:{src:t._f("emptyImage")(t.profile.image),width:"300px",height:"300px"}})]),r("div",{staticClass:"col-md-8"},[r("div",{staticClass:"card-body"},[r("h5",{staticClass:"card-title"},[t._v(t._s(t.profile.name))]),r("p",{staticClass:"card-text"},[t._v(t._s(t.profile.email))]),r("ul",{staticClass:"list-unstyled list-inline"},[r("li",[r("strong",[t._v(t._s(t.profile.Comments.length))]),t._v(" 已評論餐廳 ")]),r("li",[r("strong",[t._v(t._s(t.profile.FavoritedRestaurants.length))]),t._v(" 收藏的餐廳 ")]),r("li",[r("strong",[t._v(t._s(t.userProfile.Followings.length))]),t._v(" followings (追蹤者) ")]),r("li",[r("strong",[t._v(t._s(t.userProfile.Followers.length))]),t._v(" followers (追隨者) ")])]),r("p"),r("form",{staticStyle:{display:"contents"},attrs:{action:"",method:"GET"}},[t.profile.id===t.currentViewingUser.id?r("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"user-edit",params:{id:t.profile.id}},type:"submit"}},[t._v("編輯")]):r("div",[this.isFollowed?r("button",{staticClass:"btn btn-danger",attrs:{type:"submit"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.unfollowUser(t.profile.id)}}},[t._v(" 取消追蹤 ")]):r("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.followUser(t.profile.id)}}},[t._v(" 追蹤 ")])])],1),r("p")])])])])},l=[],c=r("2708"),u=r("4cce"),f=r("2fa3"),d={name:"UserProfileCard",mixins:[c["a"]],props:{userProfile:{type:Object,required:!0},currentUser:{type:Object,required:!0},initialIsFollowed:{type:Boolean,required:!0}},data:function(){return{profile:{},currentViewingUser:{},isFollowed:this.initialIsFollowed}},created:function(){this.getProfileData(),this.getUserData()},watch:{userProfile:function(t){this.profile=Object(o["a"])(Object(o["a"])({},this.profile),t)},initialIsFollowed:function(t){this.isFollowed=t}},methods:{getProfileData:function(){this.profile=Object(o["a"])({},this.userProfile)},getUserData:function(){this.currentViewingUser=Object(o["a"])({},this.currentUser)},followUser:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].addFollowing({userId:t});case 3:if(s=r.sent,a=s.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:e.isFollowed=!0,e.$emit("after-follow"),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.log("error",r.t0),f["a"].fire({icon:"error",title:"無法追蹤使用者，稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},unfollowUser:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].deleteFollowing({userId:t});case 3:if(s=r.sent,a=s.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:e.isFollowed=!1,e.$emit("after-unfollow"),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),f["a"].fire({icon:"error",title:"無法取消追蹤，稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},m=d,p=r("2877"),v=Object(p["a"])(m,n,l,!1,null,null,null),h=v.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[r("strong",[t._v(t._s(t.userFollowings.length))]),t._v(" followings (追蹤者) ")]),r("div",{staticClass:"card-body"},t._l(t.userFollowings,(function(e){return r("router-link",{key:e.id,attrs:{to:{name:"user",params:{id:e.id}}}},[r("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.image),width:"60",height:"60"}})])})),1)])},b=[],w={name:"UserFollowingsCard",mixins:[c["a"]],props:{userFollowings:{type:Array,required:!0}}},y=w,C=Object(p["a"])(y,g,b,!1,null,null,null),_=C.exports,F=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[r("strong",[t._v(t._s(t.userFollowers.length))]),t._v(" followers (追隨者) ")]),r("div",{staticClass:"card-body"},t._l(t.userFollowers,(function(e){return r("router-link",{key:e.id,attrs:{to:{name:"user",params:{id:e.id}}}},[r("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.image),width:"60",height:"60"}})])})),1)])},U=[],O={name:"UserFollowersCard",mixins:[c["a"]],props:{userFollowers:{type:Array,required:!0}}},j=O,x=Object(p["a"])(j,F,U,!1,null,null,null),k=x.exports,A=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[r("strong",[t._v(t._s(t.userFavorites.length))]),t._v(" 收藏的餐廳 ")]),r("div",{staticClass:"card-body"},t._l(t.favorites,(function(e){return r("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.id}}}},[r("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.image),width:"60",height:"60"}})])})),1)])},S=[],R=r("6b75");function I(t){if(Array.isArray(t))return Object(R["a"])(t)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("d3b7"),r("3ca3"),r("ddb0");function E(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var P=r("06c5");function $(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q(t){return I(t)||E(t)||Object(P["a"])(t)||$()}var D={name:"UserFavoritedRestaurantsCard",mixins:[c["a"]],props:{userFavorites:{type:Array,required:!0}},data:function(){return{favorites:[]}},created:function(){this.fetchFavorites()},watch:{userFavorites:function(t){this.favorites=Object(o["a"])(Object(o["a"])({},this.favorites),t)}},methods:{fetchFavorites:function(){this.favorites=q(this.userFavorites)}}},T=D,V=Object(p["a"])(T,A,S,!1,null,null,null),J=V.exports,M=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[r("strong",[t._v(t._s(t.userComments.length))]),t._v(" 已評論餐廳 ")]),r("div",{staticClass:"card-body"},t._l(t.comments,(function(e){return r("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.Restaurant.id}}}},[r("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.Restaurant.image),width:"60",height:"60"}})])})),1)])},B=[],G={name:"UserCommentsCard",mixins:[c["a"]],props:{userComments:{type:Array,required:!0}},data:function(){return{comments:[]}},created:function(){this.fetchComments()},watch:{userComments:function(t){this.comments=Object(o["a"])(Object(o["a"])({},this.comments),t)}},methods:{fetchComments:function(){this.comments=q(this.userComments)}}},K=G,z=Object(p["a"])(K,M,B,!1,null,null,null),H=z.exports,L=r("2f62"),N={components:{UserProfileCard:h,UserFollowersCard:k,UserFollowingsCard:_,UserFavoritedRestaurantsCard:J,UserCommentsCard:H},data:function(){return{profile:{},isFollowed:!1}},created:function(){var t=this.$route.params.id;this.fetchUser(t),console.log("current user",this.currentUser)},computed:Object(o["a"])({},Object(L["b"])(["currentUser"])),beforeRouteUpdate:function(t,e,r){var s=t.params.id;this.fetchUser(s),r()},methods:{fetchUser:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].get({userId:t});case 3:if(s=r.sent,console.log("user response",s),a=s.data,i=s.statusText,"OK"===i){r.next=8;break}throw new Error;case 8:e.profile=Object(o["a"])({},a.profile),e.isFollowed=a.isFollowed,r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](0),console.log("error",r.t0),f["a"].fire({icon:"error",title:"無法取得指定的使用者資料，稍後再試"});case 16:case"end":return r.stop()}}),r,null,[[0,12]])})))()},afterFollow:function(){var t=this;this.profile.Followers.some((function(e){return e.id===t.currentUser.id}))||this.profile.Followers.push(Object(o["a"])({},this.currentUser))},afterUnfollow:function(){var t=this;this.profile.Followers=this.profile.Followers.filter((function(e){return e.id!==t.currentUser.id}))}}},Q=N,W=Object(p["a"])(Q,s,a,!1,null,null,null);e["default"]=W.exports},"45fc":function(t,e,r){"use strict";var s=r("23e7"),a=r("b727").some,i=r("a640"),o=r("ae40"),n=i("some"),l=o("some");s({target:"Array",proto:!0,forced:!n||!l},{some:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"6b75":function(t,e,r){"use strict";function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}r.d(e,"a",(function(){return s}))},a630:function(t,e,r){var s=r("23e7"),a=r("4df4"),i=r("1c7e"),o=!i((function(t){Array.from(t)}));s({target:"Array",stat:!0,forced:o},{from:a})},d28b:function(t,e,r){var s=r("746f");s("iterator")},e01a:function(t,e,r){"use strict";var s=r("23e7"),a=r("83ab"),i=r("da84"),o=r("5135"),n=r("861d"),l=r("9bf2").f,c=r("e893"),u=i.Symbol;if(a&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var f={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new u(t):void 0===t?u():u(t);return""===t&&(f[e]=!0),e};c(d,u);var m=d.prototype=u.prototype;m.constructor=d;var p=m.toString,v="Symbol(test)"==String(u("test")),h=/^Symbol\((.*)\)[^)]+$/;l(m,"description",{configurable:!0,get:function(){var t=n(this)?this.valueOf():this,e=p.call(t);if(o(f,t))return"";var r=v?e.slice(7,-1):e.replace(h,"$1");return""===r?void 0:r}}),s({global:!0,forced:!0},{Symbol:d})}},fb6a:function(t,e,r){"use strict";var s=r("23e7"),a=r("861d"),i=r("e8b5"),o=r("23cb"),n=r("50c4"),l=r("fc6a"),c=r("8418"),u=r("b622"),f=r("1dde"),d=r("ae40"),m=f("slice"),p=d("slice",{ACCESSORS:!0,0:0,1:2}),v=u("species"),h=[].slice,g=Math.max;s({target:"Array",proto:!0,forced:!m||!p},{slice:function(t,e){var r,s,u,f=l(this),d=n(f.length),m=o(t,d),p=o(void 0===e?d:e,d);if(i(f)&&(r=f.constructor,"function"!=typeof r||r!==Array&&!i(r.prototype)?a(r)&&(r=r[v],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return h.call(f,m,p);for(s=new(void 0===r?Array:r)(g(p-m,0)),u=0;m<p;m++,u++)m in f&&c(s,u,f[m]);return s.length=u,s}})}}]);
//# sourceMappingURL=chunk-1367ab53.fb613cb6.js.map